buildPack: none
pipelineConfig:
  pipelines:
    pullRequest:
      pipeline:
        options:
          containerOptions:
            resources:
              limits:
                cpu: 4
                memory: 6144Mi
              requests:
                cpu: 1
                memory: 2048Mi
        environment:
          - name: GIT_COMMITTER_EMAIL
            value: jenkins-x@googlegroups.com
          - name: GIT_AUTHOR_EMAIL
            value: jenkins-x@googlegroups.com
          - name: GIT_AUTHOR_NAME
            value: jenkins-x-bot
          - name: GIT_COMMITTER_NAME
            value: jenkins-x-bot
          - name: GOPATH
            value: /workspace/go
          - name: GOPROXY
            value: http://jenkins-x-athens-proxy
          - name: GKE_SA
            value: /secrets/bdd/sa.json
          - name: GHE_ACCESS_TOKEN 
            valueFrom:
              secretKeyRef:
                name: jx-pipeline-git-github-ghe
                key: password
          - name: JENKINS_PASSWORD
            valueFrom:
              secretKeyRef:
                name: test-jenkins-user 
                key: password
        agent:
          image: gcr.io/jenkinsxio/builder-go-maven:2.0.885-235
        stages:
          - name: ci
            options:
              volumes:
                - name: sa
                  secret:
                    secretName: bdd-secret
                    items:
                      - key: bdd-credentials.json
                        path: bdd/sa.json
              containerOptions:
                volumeMounts:
                  - mountPath: /secrets
                    name: sa
            steps:
              - name: update-jx-website
                image: gcr.io/jenkinsxio/builder-go:2.0.885-235
                command: ./jx/scripts/update-jx-website.sh
